{{ 'sec-contact-us.css' | asset_url | stylesheet_tag }}

<style>
  .logo-upload-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 24px;
  border: 2px dashed #D1D5DB;
  border-radius: 12px;
  background-color: #F9FAFB;
  transition: all 0.3s ease;
  cursor: pointer;
  min-height: 80px;
}


.logo-upload-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background-color: #FFFFFF;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.logo-upload-icon svg {
  width: 20px;
  height: 20px;
}

.logo-upload-text {
  font-size: 16px;
  font-weight: 500;
  color: #000;
  line-height: 1.5;
  user-select: none;
}

.logo-upload-input {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
  opacity: 0;
}

.logo-upload-label {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
  z-index: 1;
}


</style>
<section class="contact-us">
  <div class="page-width">
    <div class="contact-us__grid-wrapper grid grid--2-col">
      <!-- Left Column -->
      <div class="grid__item">
        {% if section.settings.heading != blank %}
          <h1 class="h2">{{ section.settings.heading }}</h1>
        {% endif %}

        {% if section.settings.description_top != blank %}
          <div class="rte top__desc contact_des">
            {{ section.settings.description_top }}
          </div>
        {% endif %}

        {% if section.settings.email != blank %}
          <p class="contact__icon">
            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M3.75 5.25L3 6V18L3.75 18.75H20.25L21 18V6L20.25 5.25H3.75ZM4.5 7.6955V17.25H19.5V7.69525L11.9999 14.5136L4.5 7.6955ZM18.3099 6.75H5.68986L11.9999 12.4864L18.3099 6.75Z" fill="#000"></path> </g>
            </svg>
            <a href="mailto:{{ section.settings.email }}">{{ section.settings.email }}</a>
          </p>
        {% endif %}

        {% if section.settings.phone != blank %}
          <p class="contact__icon">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 1C6.5 1 8.5 5.5 8.5 6C8.5 7 7 8 6.5 9C6 10 7 11 8 12C8.39 12.39 10 14 11 13.5C12 13 13 11.5 14 11.5C14.5 11.5 19 13.5 19 14C19 16 17.5 17.5 16 18C14.5 18.5 13.5 18.5 11.5 18C9.5 17.5 8 17 5.5 14.5C3 12 2.5 10.5 2 8.5C1.5 6.5 1.5 5.5 2 4C2.5 2.5 4 1 6 1Z" stroke="#291B3B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <a href="tel:{{ section.settings.phone }}">{{ section.settings.phone }}</a>
          </p>
        {% endif %}

        {% if section.settings.description_bottom != blank %}
          <div class="rte contact_des bottom__desc">
            {{ section.settings.description_bottom }}
          </div>
        {% endif %}
        <a href="https://calendly.com/clublab" target="_blank" class="button"> prendre rendez-vous</a>
      </div>
      <!-- Right Column -->
      <div class="grid__item">
        {%- form 'contact', id: 'ContactForm', class: contact_form_class -%}
          <div class="contact_field">
            <input type="text" id="ContactFormName" placeholder="Name" name="contact[name]" required>
          </div>
          <div class="contact_field">
            <input type="email" id="ContactFormEmail" placeholder="Email" name="contact[email]" required>
          </div>
          <div class="contact_field">
            <input type="text" id="ContactFormPhone" placeholder="Phone" name="contact[phone]">
          </div>
          <div class="contact_field">
            <input type="text" id="ContactFormSubject" placeholder="Subject" name="contact[subject]">
          </div>
          <div class="contact_field">
            <textarea
              id="ContactFormMessage"
              placeholder="Type your message here..."
              name="contact[body]"
              required
            ></textarea>
          </div>
          <div class="contact_field">
            <div class="logo-upload-container col-span-2">
              <div class="logo-upload-wrapper">
                <div class="logo-upload-icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M7 10L12 5L17 10" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 5V15" stroke="#6B7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="logo-upload-text">Upload Document</div>
              </div>

              <input type="hidden" name="contact[Image file]" id="appendImage" required>
              <input
                type="file"
                name="contact[file]"
                id="ContactFormFile"
                accept="image/*"
                onchange="upload_image(this)"
                style="display:none;"
              >
                <label  class="logo-upload-label" for="ContactFormFile"></label>
            </div>
          </div>
          <button type="submit" class="btn__form-submit button btn btn_custom btn_custom--blue">Submit</button>
        {% endform %}
      </div>
    </div>
  </div>
</section>

<script>
  async function upload_image(el) {
    let file = el.files[0];
    if (file) {
      const formData = new FormData();
      formData.append('image', file);

      try {
        const res = await fetch(`https://api.imgbb.com/1/upload?key=9a6be5340f6cac47a2cec2a5d2f15b9b`, {
          method: 'POST',
          body: formData,
        });

        const data = await res.json();

        if (data.success) {
          console.log('Uploaded:', data);

          // Put direct image URL into hidden input
          let imageSelector = document.querySelector('#appendImage');
          if (imageSelector) {
            imageSelector.value = data.data.url; // direct link
          }

          // Update UI
          let containerWrapper = el.closest('.logo-upload-container');
          if (containerWrapper) {
            containerWrapper.querySelector('.logo-upload-wrapper .logo-upload-icon').style.display = 'none';
            containerWrapper.querySelector('.logo-upload-wrapper .logo-upload-text').textContent = file.name;
          }
        } else {
          console.error('Upload failed', data);
        }
      } catch (err) {
        console.error('Error uploading image:', err);
      }
    }
  }
</script>
{% schema %}
{
  "name": "Contact Us",
  "settings": [
    {
      "type": "textarea",
      "id": "heading",
      "label": "Heading",
      "default": "Get in Touch"
    },
    {
      "type": "richtext",
      "id": "description_top",
      "label": "Top Description"
    },
    {
      "type": "text",
      "id": "email",
      "label": "Email"
    },
    {
      "type": "text",
      "id": "phone",
      "label": "Phone"
    },
    {
      "type": "richtext",
      "id": "description_bottom",
      "label": "Bottom Description"
    }
  ],
  "presets": [
    {
      "name": "Contact Us"
    }
  ]
}
{% endschema %}
